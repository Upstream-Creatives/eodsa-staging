# EODSA Issues Analysis & Solutions

## üîç **Issues Identified**

### 1. **Certificate Visibility Problem**
**Issue:** Certificates not showing on dancer dashboards for scored performances (Items 44, 64)

**Root Cause:** 
- Certificates must be manually generated by admin after scoring completion
- No automatic certificate generation when performances are scored
- Dancers can only see certificates that exist in the database

**Solution:** 
- Admin needs to generate certificates via Admin Dashboard ‚Üí Certificates tab
- Consider implementing automatic certificate generation for completed performances

### 2. **Legacy Entry Issue**
**Issue:** Studios showing as "Legacy Entry" instead of proper studio names

**Root Cause:** 
- Entries created using old contestant system before studio system implementation
- Code defaults to "Legacy Entry" when studio association cannot be found
- Located in `app/api/events/[id]/entries/route.ts` lines 126-144

**Solution:** 
- Migrate legacy entries to new studio system
- Update studio associations for existing entries
- Run the `fix-legacy-entries.sql` script to identify and fix these entries

### 3. **Item 6 Not Fully Judged**
**Issue:** Item 6 shows as "Not fully Judged"

**Root Cause:** 
- Not all assigned judges have scored this performance
- System requires ALL assigned judges to score before considering "fully judged"

**Solution:** 
- Judges need to complete scoring for Item 6
- Check judge assignments and ensure all judges complete their scores

### 4. **Registration Fee Logic Issue**
**Issue:** Registration fees being charged multiple times per event

**Root Cause:** 
- Complex fee calculation system with multiple tracking mechanisms
- Registration fee should only be charged once per dancer per event
- Current logic in `lib/registration-fee-tracker.ts` and `lib/types.ts`

**Solution:** 
- Fix fee calculation to properly track per-event registration fees
- Ensure registration fee is only charged once per dancer per event
- Update payment processing to mark registration fees correctly

### 5. **MOVE Dance Company Certificate Issue**
**Issue:** MOVE Dance Company dancers not seeing their certificates

**Root Cause:** 
- Likely related to certificate generation or dancer lookup issues
- May be affected by legacy entry system or studio association problems

**Solution:** 
- Check if certificates were generated for MOVE Dance Company performances
- Verify dancer associations and studio relationships
- Regenerate certificates if needed

## üõ†Ô∏è **Immediate Actions Required**

### **For Admin:**
1. **Generate Certificates:**
   - Go to Admin Dashboard ‚Üí Certificates tab
   - Filter by performance type and style
   - Generate certificates for Items 44, 64, and other scored performances
   - Send certificates to dancers

2. **Fix Legacy Entries:**
   - Run `fix-legacy-entries.sql` to identify legacy entries
   - Update studio associations for these entries
   - Migrate to new studio system where possible

3. **Check Scoring Status:**
   - Review Item 6 scoring status
   - Ensure all assigned judges complete their scores
   - Publish scores once all judges have scored

### **For Fee Logic Fix:**
1. **Update Registration Fee Tracking:**
   - Modify fee calculation to check per-event registration status
   - Ensure registration fee is only charged once per dancer per event
   - Update payment processing to mark registration fees correctly

2. **Verify Fee Structure:**
   - Check if fees are properly structured according to EODSA guidelines
   - Ensure performance fees are calculated correctly
   - Validate registration fee amounts

## üìã **Fee Structure Verification**

Based on the image and code analysis:

**Current Fee Structure (from image):**
- Group (4 participants): R880.00 (R220 per person)
- Trio (3 participants): R840.00 (R280 per person)  
- Duet (2 participants): R560.00 (R280 per person)

**Expected Fee Structure (from code):**
- Registration Fee: R300 per dancer per event
- Solo: R300 (1), R520 (2), R700 (3), R880 (4), R1060 (5)
- Duet/Trio: R200 per dancer
- Group: R180 per dancer

**Issue:** The fees in the image don't match the expected structure from the code. This suggests either:
1. Different fee structure is being used
2. Fees are not being calculated correctly
3. Event-specific fees are overriding default fees

## üéØ **Next Steps**

1. **Immediate:** Generate certificates for scored performances
2. **Short-term:** Fix legacy entry studio associations
3. **Medium-term:** Implement automatic certificate generation
4. **Long-term:** Review and standardize fee calculation system
